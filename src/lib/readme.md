This is the legacy implementation.
