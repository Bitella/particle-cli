This is the legacy implementation. The code here will be refactored using tdd
into the `src/lib` folder. The refactoring will remove any UI-specifics from
the code, and prefer dependency injection to accessing globals.